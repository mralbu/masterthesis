[
["index.html", "Prediction of Petrophysical Properties Using Machine Learning and Hierarchical Multi-Task Linear Models Chapter 1 Introduction", " Prediction of Petrophysical Properties Using Machine Learning and Hierarchical Multi-Task Linear Models Marcelo Abstract Petrophysical characterization of reservoir rocks is a fundamental step in the evaluation of oil reservoirs, and is usually executed through laboratory experiments that incur in large costs and schedules. In this work, statistical techniques and machine learning models were evaluated fo the estimation of absolute permeability, oil-water capillary pressure and water-oil relative permeability curves, using mercury injection porosimetry, absolute permeability and porosity data. Through the exploration of several feature engineering and modeling strategies, machine learning and statistical models were assessed and compared to classical linear methods. Multi-task and hierarchical linear models were also evaluated for the estimation of special core analysis parameters from mecrcury injection porosimetry and routine core analysis data. On the evaluated dataset, hiearchical linear models were shown to have better precision, consistency and lower posterior uncertainty metrics when compared to simple linear regression models. Chapter 1 Introduction Since the beginning of the 20th century, oil and the combustion engine have transformed many aspects of modern society in fundamental ways. As a cheap and reliable energy source, oil provided the means for revolutions in transportation, manufacturing, commerce and human behavior, in general. It remains a cornerstone of our society in 2020. As knowledge of the warming effects of carbon in earth’s atmosphere is further developed, conscious and economically sustainable exploitation of remaining oil reserves becomes paramount (Mackay 2009). The high volatility of oil prices induced by supply and demand shocks in recent years further complicates the assessment of oil and gas projects. Reservoir engineering is a branch of petroleum engineering that studies fluid flow through porous hydrocarbon bearing rocks (Dake 2015). Assessment of oil and gas exploitation projects is commonly performed using numerical simulation models that incorporate geological, fluid and petrophysical information to predict oil and gas production curves. Reservoir uncertainties are particularly important at the beginning of a project, when few wells have been drilled, fluid and rock samples are scarce, and no production data is available. Figure 1.1: Reservoir Engineering Simulation Models Petrophysical characterization entails the evaluation of physical and chemical properties of porous media, and its interaction with reservoir fluids. It is commonly performed through laboratory experiments, known in the petroleum industry as routine and special core analysis (Peters 2012). Routine petrophysical experiments characterize rock porosity and absolute permeability, are considered inexpensive and can be performed in little time, usually taking no more than a couple of days per sample. Special core analysis, characterize properties related to the balance of viscous and capillary forces acting at reservoir conditions and, in many situations, can be expensive and demand long experiments, which can take up to several months to be executed (Tiab and Donaldson 2004). In this work, statistical methods were evaluated for the estimation of petrophysical properties using as input Mercury Injection Capillary Pressure (MICP) and routine core analysis data. This work is organized as follows: on chapter , petrophysical measurement methods and properties are briefly described; on chapter , black-box machine learning models for the prediction of absolute permeability from MICP data are evaluated and compared to classical linear models; on chapter , linear models for the prediction of special core analysis properties, using multi-task and hierarchical models, are studied; limitations and desirable features of the evaluated methods are further discussed on chapter . References "],
["2-petrophysical-properties.html", "Chapter 2 Measuring Petrophysical Properties 2.1 Routine Core Analysis 2.2 Special Core Analysis", " Chapter 2 Measuring Petrophysical Properties The measurement of petrophysical properties is performed through specialized laboratory experiments, which in the petroleum industry are classified as routine or special core analysis (SCAL), depending on the experiment complexity and on its investigated properties. The analyzed rock samples may be extracted from well cores or from open borehole sidewall sampling tools, and can measure from one to several centimeters (Kennedy 2015). The rock samples are commonly extracted as cylindrical plugs, but can also have irregular shapes, case in which they are referred to as rock fragments. 2.1 Routine Core Analysis Experimental measurements of a rock sample pore volume \\(V_p\\), grain volume \\(V_g\\), porosity \\(\\phi\\) and absolute permeability \\(k_{abs}\\) are commonly referred to as routine core analysis. Porous media can be pictorially described as being constituted of grain and pore spaces (Figure 2.1). The percentage of the total space occupied by pores is known as rock porosity. \\(V_p\\) and \\(\\phi\\) measurements are important for the evaluation of hydrocarbon reserve volumes. Figure 2.1: Pore media grain and pore spaces \\[\\begin{equation} \\phi = \\frac{V_p}{V_p + V_g} \\tag{2.1} \\end{equation}\\] At reservoir conditions, porous space is filled by either water, oil or gas, each of which in a separate phase. The percentage of the porous volume occupied by water, oil or gas is known as water, oil or gas saturation, respectively. \\[\\begin{equation} S_f = \\frac{V_f}{V_p},\\quad \\text{for} \\;f \\; \\text{in} \\; {w, o, g} \\tag{2.2} \\end{equation}\\] Darcy’s law (2.3) describes the linear relationship between instantaneous flow rate \\(q\\) and a pressure gradient \\(\\frac{\\partial p}{\\partial x}\\) in laminar single-phase flow (Tiab and Donaldson 2004). Given a stable steady-state single-phase flow, the porous media absolute permeability \\(k_{abs}\\) is directly proportional to the instantaneous flow rate \\(q\\), fluid viscosity \\(\\mu\\), and is inversely proportional to the pressure gradient \\(\\frac{\\partial p}{\\partial x}\\) and cross-sectional area \\(A\\). \\[\\begin{equation} q = k_{abs}\\frac{A}{\\mu}\\frac{\\partial p}{\\partial x} \\tag{2.3} \\end{equation}\\] 2.2 Special Core Analysis Measurement of multiphase properties of porous media, on which both viscous and capillary forces may be relevant, is usually more complex and incurs in longer and costlier experiments when compared to single-phase routine core analysis measurements. 2.2.1 Mercury Injection Capillary Pressure In multi-phase porous systems, due to different interaction characteristics between fluid and solid phases, the attraction between the molecules of one of the fluid phases and the solid surfaces may be greater than that of the other fluid phase. This physical behavior is known as wettability, and it is responsible for capillary forces and related phenomena. For a given multiphase porous system, with a surface tension \\(\\sigma\\) between fluid phases, wettability may be quantified by the contact angle \\(\\theta\\) formed by the fluid phase boundary-solid interface, as depicted in Figure 2.2. The Young-Laplace equation describes the capillary pressure sustained across the interface between fluids at a pore throat constriction (Tiab and Donaldson 2004). A heterogeneous porous system is connected by pore throats of several different radii. For a system consisting of mercury and mercury vapor, with surface tension \\(\\sigma_{Hg-air}\\) and contact angle \\(\\theta_{Hg-air}\\) with the rock surface, the relationship between capillary pressure and pore throat radius r may be described by equation (2.4). Capillary forces may strongly affect the distribution of fluid phases in the porous space. Figure 2.2: Contact Angle between fluid phase boundary and solid surface \\[\\begin{equation} P_c = \\frac{2\\sigma_{Hg-air} \\cos{\\theta_{Hg-air}}}{r} \\tag{2.4} \\end{equation}\\] A Mercury Injection Capillary Pressure (MICP) experiment consists of pre-specified and controlled mercury injection steps in a porous medium, previously subjected to a vacuum. It is usually performed on rock fragments with around one cubic centimeter, which allows it to be executed both in well core and sidewall sample fragments. Automated acquisition systems for MICP are commercially available (Micromeritics 2020)(Figure 2.3), making it a relatively fast and cheap experiment. A fixed pressure stabilization time and a geometric progression sequence of increasing pressure steps is defined before each MICP experiment. At each pressure step, after the pre-defined pressure stabilization time, the volume of intruded mercury in the rock sample pore space is recorded. Given calibrated mercury-mercury-vapor surface tension \\(\\sigma_{hg-air}\\) and contact angle \\(\\theta_{hg-air}\\), each pressure step may be associated with a pore throat radius according to equation (2.4). The cumulative intruded mercury volume \\(V_{hg}\\) at each step, thus, corresponds to the porous volume accessible by pore throats with radius equal to or smaller than the relationship given by equation (2.4). Mercury saturation \\(S_{hg}\\) at each step may be calculated using equation (2.5). Figure 2.3: AutoPore IV Series Mercury Porosimeter (left) and glass penetrometer (right) used in automated MICP acquisitions. \\[\\begin{equation} S_{hg} = \\frac{V_{hg}}{V_T} \\tag{2.5} \\end{equation}\\] The total fragment volume \\(V_T\\) is estimated during the experimental data interpretation procedure, using the difference of the total glass bulb volume and the intruded mercury volume necessary to “envelope” the rock fragment and start intruding the porous space. This happens at a pressure known as entrance capillary pressure \\(P_e\\) The determination of the exact value of this entrance capillary pressure may introduce uncertainty on experimental results, particularly for very irregular shaped or vuggy rock samples. The recorded capillary pressure \\(P_c\\) and mercury saturation \\(S_{hg}\\) values form a capillary pressure curve, whose format is directly related to the distribution of accessible pore volume in the porous medium of the rock sample. Figure 2.4 shows several capillary pressure curves acquired in MICP experiments. A widely used transformation of capillary pressure curves is described by equation (2.6) (Lenormand 2003), which constructs a probability distribution of accessible pore volume as a function of the logarithm of the associated pore throat radius \\(r\\). Figure 2.5 shows pore volume probability distribution curves \\(p(\\log{r})\\), for the same MICP experiments depicted in Figure 2.4. \\[\\begin{equation} p(\\log{r}) = \\frac{dS_{hg}}{d \\log{P_c}} \\tag{2.6} \\end{equation}\\] Figure 2.4: Mercury Injection Capillary Pressure Curves for several rock samples, colored by absolute permeability. Figure 2.5: Accessible pore volume probability distribution curves p(log r), for the same MICP experiments depicted in Figure 2.4. Several authors have proposed correlations between capillary pressure curve features and absolute permeability (Kolodzie 1980; Pittman 1992; Purcell 1949; Swanson 1981), among others. These correlations will be further explorer on chapter . In this work, a dataset of 2324 MICP curves acquired on rock fragments of sandstone and carbonate reservoirs from several Brazilian reservoirs was compiled. Routine and special core analysis results, performed on core sample plugs and sidewall samples extracted from the same well depths as the rock fragments were incorporated in the dataset. Given that the size of the rock fragments utilized for MICP measurements were in many cases many times smaller than the size of the corresponding core sample plugs and sidewall samples, where routine and special core analysis were performed, it is very likely that, for many samples, the rock fragments may not constitute a representative volume of the porous space (Blunt 2017). Indeed, as illustrated in Figure 2.6, it is possible to assess that heterogeneous reservoirs display many more outlier samples on correlations between MICP and core analysis data, when compared to more homogeneous reservoirs. Figure 2.6: Relationship between median pore throat radius and absolute permeability of several different reservoirs, from most to least heterogeneous 2.2.2 Centrifuge Capillary Pressure The centrifuge method is a standard technique for capillary pressure curve estimation of porous media. The method consists of imposing a capillary pressure profile on a rotating rock sample through centrifugal acceleration imposition in increasing rotation speed steps, and recording the average sample saturation at each step (Tiab and Donaldson 2004). The fundamental equations that describe the method were developed by Hassler and Brunner (Hassler and Brunner 1945): Figure 2.7: Drainage Oil-Water Centrifuge capillary pressure experiment geometry. \\[\\begin{equation} P_c = \\frac{1}{2}\\omega^2\\Delta \\rho (r^2-r_{2}^{2}) \\tag{2.7} \\end{equation}\\] \\[\\begin{equation} B = 1 - (\\frac{r_1}{r_2})^2 \\tag{2.8} \\end{equation}\\] \\[\\begin{equation} S_w = \\frac{V_w}{V_p} = \\frac{V_w}{V_w + V_o} \\tag{2.9} \\end{equation}\\] \\[\\begin{equation} \\overline{S_w}(P_c)=\\frac{(1+\\sqrt{1-B})}{2}\\int_0^1{\\frac{S_w(xP_c)}{\\sqrt{1-Bx}}} dx \\tag{2.10} \\end{equation}\\] where \\(\\omega\\) is the centrifuge rotation speed, \\(\\Delta \\rho\\) is the difference in density between the displacing and displaced fluids, \\(L\\) is the rock sample length, \\(r\\) is the radius to the centrifuge rotation center, \\(r_1\\) and \\(r_2\\) are the radial distances to the sample extremities, \\(V_p\\), \\(V_w\\) and \\(V_o\\) are the sample pore, water and oil volumes, \\(S_w (P_c)\\) is the water saturation at a given point in the sample subjected to a \\(P_c\\) capillary pressure, and \\(\\overline{S_w}\\) is the sample average water saturation. Several methods have been proposed for the estimation of capillary pressure curves from centrifuge experiments. These methods may be classified as direct or inverse according to how they solve the centrifuge saturation equation. Direct methods use several proposed differential and integral approximations of the saturation equation to directly estimate capillary-pressure curves from centrifuge experiment measurements at discrete capillary-pressure steps (Forbes 1994; Hassler and Brunner 1945; Skuse, Flroozabadl, and Ramey Jr. 1992). Inverse methods parameterize capillary-pressure curves and solve the saturation equation using non-linear regression (Bentsen 1977) or linear regression with spline basis functions (Nordtvedt and Kolltvelt 1991). Figure 2.8: Estimation of capillary pressure curve from centrifuge measurements. In this work, a dataset of 135 capillary pressure curves estimated from centrifuge experiments was compiled. Using the parameterization (2.11), proposed in (Albuquerque et al. 2018), each of the capillary pressure curves was fitted using a least-squares minimization procedure, with parameters \\(S_{wi}\\), \\(P_e\\), \\(\\alpha\\) and \\(\\beta\\). \\[\\begin{equation} S_w(P_c, S_{wi}, \\alpha, \\beta, P_w) = \\frac{1+\\alpha S_{wi}(P_c - P_e)^\\beta}{(1+\\alpha (P_c - P_e)^\\beta} \\tag{2.11} \\end{equation}\\] Figure 2.9: Sample of the experimental capillary pressure curve dataset (points) and fitted capillary pressure model (lines). This parameterization is such that for high values of capillary pressure, water saturation \\(S_w\\) approaches \\(S_{wi}\\), a parameter thus named irreducible water saturation. In a drainage capillary pressure model, the smallest pressure at which the saturation of the sample can be reduced from one hundred per cent is termed “entrance” capillary pressure (Peters 2012), modeled by parameter \\(P_e\\) in equation (2.11). The remainder parameters \\(\\alpha\\) and \\(\\beta\\) are associated with the capillary pressure curve steepness and shape. \\[\\begin{equation} \\lim_{P_c \\to +\\infty} S_w = S_{wi} \\tag{2.12} \\end{equation}\\] \\[\\begin{equation} P_c(S_{w}=1) = P_e \\tag{2.13} \\end{equation}\\] Considering a transformation analogous to the one utilized for mercury injection capillary pressure curves (2.6), pore volume probability distribution curves \\(p(\\log r)\\) may be estimated from the fitted centrifuge capillary pressure curve parameters, as described by equation (2.14). \\[\\begin{equation} p(\\log r) = \\frac{dS_w}{d \\log{P_c}} = \\frac{\\alpha \\beta S_{wi} (S_w - S_{wi})(P_c - P_e)^{\\beta - 1}}{1 + \\alpha (P_c - P_e)^\\beta} \\tag{2.14} \\end{equation}\\] Figure 2.10: Sample centrifuge capillary pressure curves, parameterized by equation (2.11), and corresponding pore volume probability distribution curves p(log r). As graphically displayed in Figure 2.10, the parameter \\(\\alpha\\) can be shown to be associated with the location of the distribution \\(p(\\log{r})\\) and the parameter \\(\\beta\\) can be shown to be associated with its scale or dispersion. A dataset combining the fitted centrifuge capillary pressure curve parameters and several MICP features, detailed on chapter , of rock fragments extracted from corresponding core locations was assembled. As exemplified in Figure 2.11, associated pore volume distributions of corresponding centrifuge capillary pressure and MICP curves often display similar distributions, though to varying degrees as MICP curves may have been measured in rock fragments which may or may not be representative of its associated core sample pore volume. MICP experiments also cover a larger range of pore throat radius sizes and display significantly more detail, as a much tighter pressure and corresponding pore throat radius experimental grid is sampled. Figure 2.11: Associated pore volume distributions p(log r) of correspondent Centrifuge Capillary Pressure (blue curve) and MICP (black curve) samples. In Figure 2.12, it is possible to identify significant correlations between corresponding centrifuge capillary pressure curves \\(\\alpha\\), \\(S_{wi}\\) and MICP median pore throat radius \\(r_{median}\\) parameters. Both \\(\\alpha\\) and \\(S_{wi}\\) parameters can be seen, thus, as correlated with the location of the distribution \\(p(\\log{r})\\). Figure 2.12: Correlations between parameters alpha, Swi and median pore throat radius of correspondent rock fragment p(log r) distribution. 2.2.3 Relative Permeability In porous media multiphase flow, relative permeability describes the linear proportion by which each fluid flow is penalized when compared to Darcy’s law (2.3). For a water-oil two-phase flow, the following relations describe oil (\\(k_{ro}\\)) and water (\\(k_{rw}\\)) relative permeability, and the their associated fractionary water flow (\\(f_{w}\\)). \\[\\begin{equation} q_o(S_w) = k_{ro}(S_w) \\frac{k_{abs}A}{\\mu_o L} \\Delta p \\tag{2.15} \\end{equation}\\] \\[\\begin{equation} q_w(S_w) = k_{rw}(S_w) \\frac{k_{abs}A}{\\mu_w L} \\Delta p \\tag{2.16} \\end{equation}\\] \\[\\begin{equation} f_w = \\frac{\\frac{k_{rw}}{\\mu_w}}{\\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o}} \\tag{2.17} \\end{equation}\\] The most widely used experimental setup for water-oil relative permeability determination is the unsteady-state water-oil relative permeability experiment. In a unsteady-state water-oil relative permeability experiment, a sample initially satured at irreducible water saturation \\(S_{wi}\\) condition is subjected to a constant rate water injection, simulating reservoir secondary recovery water injection. During the experiment, water injection flow rate \\(q_{w_{inj}}\\) and exit pressure \\(P_{out}\\) are kept constant, and cumulative oil production \\(N_p\\) and pressure differential \\(\\Delta p\\) are recorded. Figure 2.13: Unsteady-state relative permeability experimental setup. \\[\\begin{equation} q_{w_{inj}} = cte \\tag{2.18} \\end{equation}\\] \\[\\begin{equation} P_{out} = cte \\tag{2.19} \\end{equation}\\] Unsteady state water-oil relative permeability experiments are usually interpreted using either the JBN method (Johnson, Bossler, and Naumann 1959) or using history matched numerical simulated solutions (Lenormand and Lenormand 2016). Figure 2.14 displays an example of recorded and history matched cumulative oil production \\(N_p\\) and pressure differential \\(\\Delta p\\), obtained using maximum likelihood estimation of the relative permeability parameters that best fit the recorded experimental data. Figure 2.14: Example of history matched experimental data. Figure 2.15: Example of history matched relative permeability and fractionary flow curves compared to analytic JBN interpreted experimental results. History matching is usually performed using parametric relative permeability models and finite difference partial differential equations simulation. The Corey model (Corey 1954), given by equations (2.20)(2.21)(2.22), is a widely used power-law model for relative permeability curves, whose parameters \\(n_o\\) and \\(n_w\\) are commonly referred to as Corey exponents. \\[\\begin{equation} S_{wD} = \\frac{S_w - S_{wi}}{1 - S_{wi} - S_{or}} \\tag{2.20} \\end{equation}\\] \\[\\begin{equation} k_{ro}(S_w) = k_{ro@S_{wi}}(1-S_{wD})^{n_o} \\tag{2.21} \\end{equation}\\] \\[\\begin{equation} k_{rw}(S_w) = k_{rw@S_{or}}(S_{wD})^{n_w} \\tag{2.22} \\end{equation}\\] The LET model (Lomeland, Ebeltoft, and Thomas 2005), given by equations (2.23)(2.24), was developed with six shape parameters \\(L_o\\), \\(E_o\\), \\(T_o\\), \\(L_w\\), \\(E_w\\), \\(T_w\\), and can accommodate much more flexible relative permeability curves. It is commonly used in reservoir simulation models, especially for history matching procedures that demand flexible representations of relative permeability models. \\[\\begin{equation} k_{ro}(S_w) = k_{ro@S_{wi}}\\frac{(1-S_{wD})^{L_o}}{(1-S_{wD})^{L_o} + E_o(S_{wD})^{T_o}} \\tag{2.23} \\end{equation}\\] \\[\\begin{equation} k_{rw}(S_w) = k_{rw@S_{or}}\\frac{(S_{wD})^{L_w}}{(S_{wD})^{L_w} + E_w(1-S_{wD})^{T_w}} \\tag{2.24} \\end{equation}\\] In this work, a dataset of 226 unsteady-state water-oil relative permeability curves was assembled. LET parameters for each of the 226 curves were fit using maximum likelihood estimation (DeGroot and Schervish 2012). Multivariate and multi-task linear regression models built using this dataset are described on chapter . References "],
["3-kabs-regression.html", "Chapter 3 Absolute Permeability Regression 3.1 Mercury Porosimetry Feature Engineering 3.2 Absolute Permeability Regression Models", " Chapter 3 Absolute Permeability Regression Several authors have studied the use of MICP curves to estimate absolute permeability. Many of the proposed regression models use linear correlations between the logarithm of absolute permeability \\(\\log{k_{abs}}\\) and many different proposed capillary pressure curve features (Kolodzie 1980; Pittman 1992; Purcell 1949; Swanson 1981). Comparison of linear regression and machine learning models for the estimation of absolute permeability using MICP data has been performed on datasets from middle-east reservoirs by several authors (Al Khalifah, Glover, and Lorinczi 2020; Nooruddin, Anifowose, and Abdulraheem 2013), showing promising results for non-linear machine learning models. In this work, a comparison of linear regression and machine learning models for the estimation of absolute permeability using MICP data is performed on a dataset of 2324 MICP curves acquired on rock fragments of sandstone and carbonate reservoirs from several Brazilian reservoirs. 3.1 Mercury Porosimetry Feature Engineering Several feature engineering and regression techniques were evaluated on the assembled MICP dataset, exploring both linear correlation features as well as non-linear transformations. The following sections describe each of the feature extraction procedures and the choice and training of the selected regression models. 3.1.1 Statistical Features For each capillary pressure curve and associated pore volume probability distribution \\(p(\\log{r})\\), mean pore throat radius \\(r_{mean}\\) and median pore throat radius \\(r_{median}\\) were calculated. Quantiles ranging from the 15th to the 90th pore throat radius values were estimated {\\(r_{15},r_{20},...,r_{85},r_{90}\\)}. As a proxy for distribution heterogeneity, the interquartile-range \\(iqr\\), given by the difference of pore-throat radius associated with the 25th and 75th quartiles of the \\(p(\\log{r})\\) distribution was estimated. \\[\\begin{equation} iqr = r_{25} - r_{75} \\tag{3.1} \\end{equation}\\] 3.1.2 Linear Features The following features, whose main authors are listed on Table 3.1 as feature names, were calculated for each one of the datasets MICP curves. Each of these features is associated with a linear equation, proposed by its authors as regression models for \\(\\log{k_{abs}}\\). Table 3.1: Classical MICP linear correlation features Feature Name Feature Linear Equation Swanson (Swanson 1981) \\((\\frac{S_{hg}\\phi}{P_c})_{max}\\) \\(\\log{k_{abs}}=a+b.(\\frac{S_{hg}\\phi}{P_c})_{max}\\) Purcell (Purcell 1949) \\(\\int_0^1{\\frac{dS_{hg}}{P_c^2}}\\) \\(\\log{k_{abs}}=a+b.\\int_0^1{\\frac{dS_{hg}}{P_c^2}}\\) Winland (Kolodzie 1980) \\(r_{35}\\) \\(\\log{k_{abs}}=a + b . r_{35}\\) Pittman (Pittman 1992) \\(r_{apex}\\) \\(\\log{k_{abs}}=a+b.r_{apex}\\) Dastidar (Dastidar 2007) \\(r_{WGM}=[\\prod_{i=1}^nr_i^{w_i}]^{1/\\sum{w_i}}\\) \\(\\log{k_{abs}}=a+b.\\phi +c.r_{WGM}\\) 3.1.3 Pore Throat Size Class Distribution Pore throat size ternary class distributions were calculated for each \\(p(\\log{r})\\) distribution, assigning classes micro, meso and macro to the percentage of the pore volume associated with pore throat sizes bellow 0.5 \\(\\mu m\\), between 0.5 \\(\\mu m\\) and 2.5 \\(\\mu m\\), and above 2.5 \\(\\mu m\\), respectively. Figure 3.1 displays examples of ternary plots for micro, meso and macro pore volume percentage for \\(p(\\log{r})\\) distributions of samples from reservoirs of two Brazilian fields A and B. Figure 3.1: Pore-throat class distribution for two sample reservoirs (A and B). 3.1.4 Gaussian Mixture Fit Features Following the methodology proposed by (Xu and Torres-Verdín 2013), bimodal gaussian mixture distributions, with parameters \\(\\mu_1\\), \\(\\mu_2\\), \\(\\sigma_1\\), \\(\\sigma_2\\), \\(\\lambda_1\\) and \\(\\lambda_2\\), were fitted to each MICP associated pore volume distributions \\(p(\\log{r})\\), using the following approximation. \\[\\begin{equation} p(\\log{r}) \\approx \\lambda_1 \\frac{1}{\\sqrt{2\\pi}\\sigma_1}\\exp{\\frac{-(\\log{r}-\\mu_1)}{2\\sigma_1^2}} + \\lambda_2 \\frac{1}{\\sqrt{2\\pi}\\sigma_2}\\exp{\\frac{-(\\log{r}-\\mu_2)}{2\\sigma_2^2}} \\tag{3.2} \\end{equation}\\] \\[\\begin{equation} \\lambda_1 + \\lambda_2 = 1 \\tag{3.3} \\end{equation}\\] The parameters \\(\\mu_1\\), \\(\\mu_2\\), \\(\\sigma_1\\), \\(\\sigma_2\\), \\(\\lambda_1\\) and \\(\\lambda_2\\), provide a compact representation of the MICP associated pore volume distributions \\(p(\\log{r})\\), as exemplified in Figures 3.2 and 3.3. Figure 3.2: Example of bimodal gaussian mixture fit of p(log r) distribution. Figure 3.3: Gaussian mixture (red lines) fitted to p(log r) distributions of MICP data samples (black lines). 3.1.5 Dimensionality Reduction Features Both linear and non-linear dimensionality reduction methods were used to extract features from the dataset of MICP curves. Dimensionality reduction techniques allow for the approximation of the dataset using a lower-dimensional representation, useful for data exploration and visualization and for data compression. Using as input pore-throat radius quantiles {\\(r_{15},r_{20},...,r_{85},r_{90}\\)}, the first two principal components PC1 and PC2 were estimated for each of the sample MICP curves using Principal Component Analysis (Hastie, Tibshirani, and Friedman 2009). The first two principal components represented a total of 96.1% of the variance in the dataset. A graphical depiction of the PC1 and PC2 features, colored by absolute permeability can be seen on Figure 3.4. The first and second principal components were shown to be correlated with absolute permeability \\(k_{abs}\\) and interquartile range \\(iqr\\), respectively, as displayed on Figures 3.5 and 3.6. Figure 3.4: First two principal components of each of the datasets MICP samples. Figure 3.5: Negative correlation between absolute permeability and the first principal component. Figure 3.6: Positive correlation between the interquartile-range iqr and the second principal component PC2. Non-linear dimensionality reduction features were also estimated using Uniform Manifold Approximation and Projection, also known as UMAP (McInnes and Healy 2018), using as input pore-throat radius quantiles {\\(r_{15},r_{20},...,r_{85},r_{90}\\)}. Figure 3.7: MICP curves non-linear decomposition using UMAP. The Uniform Manifold Approximation and Projection technique constructs a high dimensional graph representation of the data and optimizes a low-dimensional manifold to be as structurally similar to the high dimensional graph as possible (McInnes and Healy 2018). Due to its distance preserving properties, the low-dimensional manifold, represented in Figure 3.7 by variables \\(x_1.umap\\) and \\(x_2.umap\\), is useful for visualization and identification of similar MICP curve samples. In Figure 3.8, this property is exemplified by a sequence of three pairs of plots, showing that samples mapped to the same regions of the UMAP manifold, marked in the red in each of the plot pairs, correspond to distributions \\(p(\\log{r})\\) with similar characteristics. Figure 3.8: Manifold maps (left) showing areas with similar associated pore volume distributions p(log r) (right). 3.2 Absolute Permeability Regression Models The regression metrics root mean squared error (3.4), median absolute error (3.5) and \\(R^2\\) (3.6) were evaluated for the trained regression models. Due to the issues regarding the representativeness of the rock fragments with respect to the measured absolute permeability values, discussed on chapter , minimization of the median absolute deviation metric (3.5) was chosen to increase the robustness to outliers of the trained non-linear regression models, described in section . In both linear and non-linear regression methods, the \\(R^2\\) metric (3.6) was used for further assessment of the trained regression models. \\[\\begin{equation} \\text{RMSE} = \\sqrt{\\frac{\\sum_{i=1}^n{(\\log{\\hat{k}_{{abs}_i}}-\\log{k_{{abs}_i}})^2}}{n}} \\tag{3.4} \\end{equation}\\] \\[\\begin{equation} \\text{MAE} = \\frac{\\sum_{i=1}^n{|\\log{\\hat{k}_{{abs}_i}}-\\log{k_{{abs}_i}}}|}{n} \\tag{3.5} \\end{equation}\\] \\[\\begin{equation} R^2 = 1-\\frac{\\sum_{i=1}^n{(\\log{\\hat{k}_{{abs}_i}}-\\log{k_{{abs}_i}})^2}}{\\sum_{i=1}^n{(\\log{k_{{abs}_i}}-\\overline{\\log{k_{{abs}_i}}})^2}} \\tag{3.6} \\end{equation}\\] 3.2.1 Linear Regression Models The linear features, described in section , were used to fit linear regression logarithmic absolute permeability \\(\\log{k_{abs}}\\) models. Among the fitted linear regression models, the Winland and Swanson models obtained the lowest root mean squared error and highest coefficient of determination metrics. Figure 3.9 shows a graphical representation of the fitted models, where a significant number of outlier logarithmic absolute permeability estimates \\(\\log{\\hat{k}_{abs}}\\) , with more than one order of magnitude errors, can be seen. The presence of this large number of outliers can be explained by the limited rock fragment representativeness of the core sample pore volume for heterogeneous reservoirs, described in chapter . Figure 3.9: Visual evaluation of the predicted and observed absolute permeability models using linear features. Figure 3.10: Comparison of the \\(R^2\\) metric for the fitted linear regression models. 3.2.2 Black-Box Machine Learning Models Using the features described in section , six additional non-linear regression models were fit to the dataset using machine learning models. The 2324 MICP curves were split between training and test data, with a eighty to twenty percent ratio. Using the training set, each algorithm went through a hyper-parameter tuning procedure, using ten times repeated five-fold cross-validation error estimation, on a grid of selected hyper-parameters. Two \\(knn\\) nearest neighbors models (P. Murphy 2012), were fit to the training set, one using features extracted using PCA (Hastie, Tibshirani, and Friedman 2009) and the other features extracted using UMAP non-linear dimensionality reduction (McInnes and Healy 2018). A simple linear regression model was fit using the features extracted from the bi-modal gaussian mixture model proposed by (Xu and Torres-Verdín 2013), described in section . A support vector regression (SVR) model, a random forest model and a gradient boosted trees model (Hastie, Tibshirani, and Friedman 2009) were fit to an expanded feature set, consisting of the features proposed by Swanson, Winland, Purcell, the sample porosity \\(\\phi\\), the micropores and mesopores ternary class distributions, the UMAP features and the bi-modal gaussian mixtures distribution features. A pre-processing standardizing step was applied to each feature. The gradient boosted trees model was fitted using the implementation provided by the XGBoost library (Chen and Guestrin 2016). Figure 3.11: Five-fold cross-validation procedure. Table 3.2 and Figure 3.12 show median values of repeated five-fold cross-validated MAE, \\(R^2\\) and RMSE metrics for each of the trained regression models. The regression models with the lowest median absolute error were the SVR, randomForest and gradient boosted trees XGB models. Through the use of a radial basis function kernel and an optimization procedure that minimizes hinge loss (Hastie, Tibshirani, and Friedman 2009), the SVR algorithm provides outlier robust predictions. The random forest and gradient boosted trees algorithms use randomized selection of features and data subsets, bagging and boosting techniques, respectively, to reduce prediction errors of ensembles of simpler decision tree models (Chen and Guestrin 2016). Table 3.2: Median repeated five-fold cross-validated MAE, \\(R^2\\) and RMSE metrics for each model. Regression Model MAE \\(R^2\\) RMSE SVR 0.412 0.722 0.596 randomForest 0.437 0.712 0.604 XGB 0.439 0.711 0.605 Swanson 0.471 0.681 0.639 GaussianMixture 0.477 0.675 0.641 Winland 0.481 0.674 0.643 Purcell 0.487 0.661 0.654 Dastidar 0.520 0.642 0.673 knnUMAP 0.565 0.562 0.744 knnPCA 0.581 0.547 0.753 Pittman 0.613 0.523 0.775 Figure 3.12: Boxplots for repeated five-fold cross-validated MAE, \\(R^2\\) and RMSE metric results for each model. Non-linear machine learning models presented consistently lower prediction errors, as can be seen on Figure 3.12. On Figure 3.13, a visual comparison between linear and non-linear machine learning models of the predicted versus measured data for the test dataset is shown. Although the non-linear machine-learning models did obtain better MAE, \\(R^2\\) and RMSE metrics results, a significant number of outliers are still present, probably related to the issue of limited rock fragment representativeness of highly heterogeneous reservoirs described in chapter . Figure 3.13: Visual evaluation of the estimated absolute permeability models using Machine Learning and linear models. References "],
["4-hierarchical-linear-regression.html", "Chapter 4 Hierarchical Multi-Task Linear Regression 4.1 Multi-Task Linear Regression 4.2 Hierarchical Linear Regression", " Chapter 4 Hierarchical Multi-Task Linear Regression Linear regression methods are widely used in petrophysical characterization. Compared to non-linear machine learning models, they have as advantages simplicity, interpretability and their inherent linear behavior on extrapolated predictions. For the estimation of special core analysis properties, which are costly to acquire and thus usually scarce, simple models with a low number of parameters and that can deliver interpretable probabilistic inferences are highly desirable. In this work, two different linear regression techniques are evaluated on special core analysis datasets. On a dataset containing 135 capillary pressure curves estimated from centrifuge experiments, a multi-task linear regression model is fit and evaluated, and some of its properties are analyzed. On another dataset, containing 226 unsteady-state water-oil relative permeability curves, partially pooled hierarchical linear regression models are evaluated and compared to simple linear regression models. 4.1 Multi-Task Linear Regression Using the parameterization (4.1), proposed by (Albuquerque et al. 2018), a dataset containing parameters \\(S_{wi}\\), \\(P_e\\), \\(\\alpha\\) and \\(\\beta\\) fitted to each of the available 135 centrifuge capillary pressure curves, was assembled. \\[\\begin{equation} S_w(P_c, S_{wi}, P_e, \\alpha, \\beta) = \\frac{1+\\alpha S_{wi}(P_c - P_e)^\\beta}{(1+\\alpha (P_c - P_e)^\\beta} \\tag{4.1} \\end{equation}\\] To each of these samples, features extracted from MICP curves obtained on corresponding rock fragments were associated in a dataset containing {\\(S_{wi}\\), \\(P_e\\), \\(\\alpha\\), \\(\\beta\\), \\(k_{abs}\\), \\(r_{35}\\), \\(iqr\\)} values for each MICP and centrifuge capillary pressure curve pair. Significant correlations between corresponding centrifuge capillary pressure curves \\(\\alpha\\), \\(S_{wi}\\) and MICP median pore throat radius \\(r_{median}\\) parameters can be visualized in Figure 4.2. Figure 4.1: Sample of the experimental capillary pressure curve dataset (points) and fitted capillary pressure model (lines). Figure 4.2: Correlations between parameters alpha, Swi and median pore throat radius of correspondent rock fragment p(log r) distribution. Given \\(x\\) a vector of input parameters {\\(k_{abs}\\), \\(r_{35}\\), \\(iqr\\)} and y a vector of output parameters {\\(S_{wi}\\), \\(\\alpha\\), \\(\\beta\\), \\(P_e\\)}, and considering a multivariate gaussian distribution described by equation (4.2), the conditional distribution of the output parameters given known input parameters \\(p(y|x)\\) may be described by equations (4.3)(4.4)(4.5). Estimating mean and covariance matrix statistics of the multivariate gaussian distribution (4.2) on the assembled dataset, using maximum likelihood methods (DeGroot and Schervish 2012), inference and uncertainty evaluation may be performed on desired new input \\(x\\) values. \\[\\begin{equation} \\begin{pmatrix} x \\\\ y \\end{pmatrix} \\sim \\mathcal{N}\\left(\\begin{pmatrix} \\mu_x \\\\ \\mu_y \\end{pmatrix},\\begin{pmatrix} \\Sigma_{xx} &amp; \\Sigma_{xy} \\\\ \\Sigma_{yy} &amp; \\Sigma_{xy} \\end{pmatrix}\\right) \\tag{4.2} \\end{equation}\\] \\[\\begin{equation} p(y|x) \\sim \\mathcal{N}(\\mu_{y|x}, \\Sigma_{y|x}) \\tag{4.3} \\end{equation}\\] \\[\\begin{equation} \\mu_{y|x} = \\mu_y + (\\Sigma_{xx}^{-1}\\Sigma_{yx})^t(x-\\mu_x) \\tag{4.4} \\end{equation}\\] \\[\\begin{equation} \\Sigma_{y|x} = \\Sigma_{yy} - \\Sigma_{xy}^{t}\\Sigma_{xx}^{-1}\\Sigma_{yx} \\tag{4.5} \\end{equation}\\] Given new \\(x=\\{k_{abs}, r_{35}, iqr\\}\\) values, the expected capillary pressure curve parameters \\(E[y|x]\\) may be obtained by the conditional mean \\(\\mu_{y|x}\\). Uncertainty evaluation of this prediction may be executed using samples of the conditional distribution \\(p(y|x)\\). Figure 4.3 displays examples of experimental capillary pressure curves and predictions of these curves using as input associated \\(\\{k_{abs}, r_{35}, iqr\\}\\) values. Samples from the conditional distribution \\(p(y|x)\\) are shown as grey lines and illustrate prediction uncertainty. Figure 4.3: Visual comparison of experimental capillary pressure curves (blue lines), samples from the conditional distribution (grey lines) and average predicted curves (dashed black lines). On Figure 4.4, a comparison between experimental and predicted capillary pressure curve parameters is shown. Due to inherent noise associated with heterogeneous reservoir rocks and, as also observed in Figure 4.3, there is significant dispersion of experimental and predicted parameters values. Both in Figures 4.4 and 4.5, it is possible to visualize that capillary curve parameter predictions follow linear tendencies with absolute permeability. This property of linear model predictions is desirable, as it follows the expected physical behavior of reservoir rocks. Figure 4.4: Experimental capillary pressure curve parameters (blue dots and line tendency) and predicted parameters estimated using the posterior mean (black dots). Figure 4.5: Behaviour of predicted capillary pressure curves with absolute permeability. 4.2 Hierarchical Linear Regression In a reservoir model, the prediction of petrophysical properties on simulation cells distant from wells with available sampled cores is commonly performed using linear regression methods (Peters 2012). To account for sampling bias, special core analysis properties such as relative permeability and capillary pressure are commonly scaled according to reservoir wide available information, such as absolute permeability, porosity and geological facies models. For relative permeability, this procedure is commonly performed using simple linear regression (Gelman et al. 2014) of relative permeability parameters as a function of absolute permeability. On this work, simple linear and hierarchical linear regression models were evaluated in a dataset containing 226 unsteady-state water-oil relative permeability curves from several Brazilian reservoirs. Parameters for each of the 226 curves were fitted using maximum likelihood estimation (Migon, Gamerman, and Louzada 2015) and the LET parameterization (4.6)(4.7)(4.8) proposed in (Lomeland, Ebeltoft, and Thomas 2005). \\[\\begin{equation} S_{wD} = \\frac{S_w - S_{wi}}{1 - S_{wi} - S_{or}} \\tag{4.6} \\end{equation}\\] \\[\\begin{equation} k_{ro}(S_w) = k_{ro@S_{wi}}\\frac{(1-S_{wD})^{L_o}}{(1-S_{wD})^{L_o} + E_o(S_{wD})^{T_o}} \\tag{4.7} \\end{equation}\\] \\[\\begin{equation} k_{rw}(S_w) = k_{rw@S_{or}}\\frac{(S_{wD})^{L_w}}{(S_{wD})^{L_w} + E_w(1-S_{wD})^{T_w}} \\tag{4.8} \\end{equation}\\] Categorical variables, such as field, reservoir or geological facies, may be used to group petrophysical models. A model that does not distinguish between groups, using constant intercept and slope parameters for all categories according to equation (4.9), may be referred to as a non-pooled model (Gelman et al. 2014). Figure 4.6 displays a simple linear non-pooled regression model of irreducible water saturation \\(S_{wi}\\) as the predicted \\(y\\) variable and the logarithm of absolute permeability \\(\\log{k_{abs}}\\) as the observed \\(x\\) variable. On equation (4.9), \\(n\\) represents the total number of data samples, indexed by the letter \\(i\\), and \\(\\alpha\\), \\(\\beta\\) and \\(\\sigma_y^2\\) represent the intercept, slope and variance linear model parameters. \\[\\begin{equation} y_i \\sim \\mathcal{N}(\\alpha + \\beta x, \\sigma_y^2),\\quad \\text{for}\\; i=1,...,n \\tag{4.9} \\end{equation}\\] Figure 4.6: Non-pooled simple linear regression. Usually, though, separate linear regression models are fitted to each category of interest, in models that may be referred to as completely pooled. For each category \\(j\\), independent \\(\\alpha_j\\), \\(\\beta_j\\) and \\(\\sigma_{y^j}^2\\) parameters are estimated, as described in equation (4.10). \\[\\begin{equation} y_i^j \\sim \\mathcal{N}(\\alpha_j + \\beta_j x_i^j, \\sigma_{y^j}^2),\\quad \\text{for}\\; i=1,...,n; \\quad \\text{for} \\; i=1,...,J \\tag{4.10} \\end{equation}\\] Figure 4.7 displays a simple linear completely pooled regression model of irreducible water saturation \\(S_{wi}\\) and the logarithm of absolute permeability \\(\\log{k_{abs}}\\), grouped by reservoir. In completely pooled regression models, each linear regression model is independent of each other, with varying degrees of uncertainty on each model parameters \\(\\alpha_j\\), \\(\\beta_j\\) and \\(\\sigma_{y^j}^2\\). Categories with larger number of samples and smaller heterogeneities, usually display smaller uncertainties on model parameters. Figure 4.7: Completely pooled simple linear regression models, grouped by reservoir. Hierarchical or partially pooled linear regression models introduce information sharing and coupling between model parameters of different categories, modeling intercept and/or slope parameters as sampled from a latent parent distribution. Varying intercept models, assume that the intercept of each category \\(\\alpha_j\\) is sampled from a common latent gaussian distribution (4.12). This information sharing, has a regularizing effect of shrinking the partially pooled parameters towards a common mean \\(\\mu_\\alpha\\). \\[\\begin{equation} y_i^j \\sim \\mathcal{N}(\\alpha_j + \\beta_j x_i^j, \\sigma_{y^j}^2),\\quad \\text{for}\\; i=1,...,n; \\quad \\text{for} \\; j=1,...,J \\tag{4.11} \\end{equation}\\] \\[\\begin{equation} \\alpha_j \\sim \\mathcal{N}(\\mu_\\alpha, \\sigma_\\alpha^2), \\quad \\text{for} \\; j=1,...,J \\tag{4.12} \\end{equation}\\] Varying slope models, assume that the slope of each category \\(\\beta_j\\) is sampled from a common latent gaussian distribution (4.14), with the same regularizing effect of shrinking the partially pooled parameters towards a common mean \\(\\mu_\\beta\\). \\[\\begin{equation} y_i^j \\sim \\mathcal{N}(\\alpha_j + \\beta_j x_i^j, \\sigma_{y^j}^2),\\quad \\text{for}\\; i=1,...,n; \\quad \\text{for} \\; j=1,...,J \\tag{4.13} \\end{equation}\\] \\[\\begin{equation} \\beta_j \\sim \\mathcal{N}(\\mu_\\beta, \\sigma_\\beta^2), \\quad \\text{for} \\; j=1,...,J \\tag{4.14} \\end{equation}\\] Varying intercept and slope models, assume that both the intercept and slope of each category \\(\\alpha_j\\) and \\(\\beta_j\\) are sampled from a common latent multivariate gaussian distribution (4.16). \\[\\begin{equation} y_i^j \\sim \\mathcal{N}(\\alpha_j + \\beta_j x_i^j, \\sigma_{y^j}^2),\\quad \\text{for}\\; i=1,...,n; \\quad \\text{for} \\; j=1,...,J \\tag{4.15} \\end{equation}\\] \\[\\begin{equation} \\begin{pmatrix} \\alpha_j \\\\ \\beta_j \\end{pmatrix} \\sim \\mathcal{N}\\left(\\begin{pmatrix} \\mu_\\alpha \\\\ \\mu_\\beta \\end{pmatrix},\\begin{pmatrix} \\sigma_\\alpha^2 &amp; \\rho \\sigma_\\alpha \\sigma_\\beta \\\\ \\rho \\sigma_\\alpha \\sigma_\\beta &amp; \\sigma_\\beta^2 \\end{pmatrix}\\right),\\quad \\text \\quad \\text{for} \\; j=1,...,J \\tag{4.16} \\end{equation}\\] For the dataset of 226 unsteady-state water-oil relative permeability curve LET parameters, hierarchical varying slope models of relative permeability endpoint parameters \\(S_{wi}\\), \\(S_{or}\\), \\(k_{ro}@S_{wi}\\) and \\(k_{rw}@S_{or}\\), and logarithm of absolute permeability \\(\\log{k_{abs}}\\) were fit and compared to completely pooled simple linear regression models, grouped by reservoir. Both hierarchical and simple linear regression model parameters were inferred using bayesian Hamiltonian Markov-Chain Monte-Carlo (Hoffman and Gelman 2014) and the software Stan (Carpenter et al. 2017). Default weakly informative model parameter priors were utilized, following the recommendations of (Gelman et al. 2008). Comparison between hierarchical and simple linear regression models were performed using the root mean squared error RMSE, the Watanabe-Akaike Information Criteria (WAIC), the leave-one-out information criteria (LOOIC), and the bayesian R-squared \\(R^2\\) and adjusted R-squared \\(R_{adj}^2\\) metrics (Gelman et al. 2019)(Vehtari, Gelman, and Gabry 2017). The WAIC and LOOIC information criteria provide a trade-off between goodness-of-fit and model complexity, with lower WAIC and LOOIC values corresponding to lower cross-validation errors. Hierarchical varying slope and simple linear regression models of irreducible water saturation \\(S_{wi}\\) and logarithm of absolute permeability \\(\\log{k_{abs}}\\) were evaluated on the assembled dataset. Table 4.1 displays the obtained regression metrics for each fitted model. Hierarchical linear regression achieved slightly better WAIC, LOOIC and \\(R_{adj}^2\\) metrics. Table 4.1: \\(S_{wi}\\) linear regression model metrics. Regression Model RMSE WAIC LOOIC \\(R^2\\) \\(R_{adj}^2\\) Simple Linear Regression 0.05 -681.48 -680.96 0.20 0.16 Hierarchical Linear Regression 0.05 -684.89 -684.66 0.24 0.17 Figure 4.8 displays simple and hierarchical linear regression \\(S_{wi}\\) vs \\(\\log{k_{abs}}\\) models, grouped by reservoir. Black dots represent observed samples, light blue lines represent samples from the posterior distribution of intercept and slope parameters, and dark blue lines represent mean intercept and slope parameters, for each reservoir. Completely pooled, simple linear regression models display larger between-groups slope variations and uncertainty, as shown in Figure 4.9. Reservoirs with large number of samples, such as reservoir F, display only small changes between hierarchical and simple linear regression model posterior distributions. A stronger regularizing effect is displayed in reservoir H, which contains a small number of samples. Overall behavior consistency of \\(S_{wi}\\) with respect to \\(\\log{k_{abs}}\\) is increased in the hierarchical partially pooled linear model, as slopes are regressed towards a common mean. As information is shared between different reservoirs, posterior uncertainties are noticeably reduced in the hierarchical linear model. Figure 4.8: Simple (top) and Hierarchical (bottom) linear regression models of Swi vs log(kabs), grouped by reservoir. Figure 4.9: Intercept (top) and slope (bottom), simple and hierarchical linear regression Swi vs log(kabs) model parameters, grouped by reservoir. Hierarchical varying slope and simple linear regression models of residual oil saturation \\(S_{or}\\) and logarithm of absolute permeability \\(\\log{k_{abs}}\\) were evaluated on the assembled dataset. Table 4.2 displays the obtained regression metrics for each fitted model. Both models achieved similar WAIC, LOOIC and \\(R_{adj}^2\\) metrics. Table 4.2: \\(S_{or}\\) linear regression model metrics. Regression Model RMSE WAIC LOOIC \\(R^2\\) \\(R_{adj}^2\\) Simple Linear Regression 0.09 -414.47 -413.64 0.18 0.11 Hierarchical Linear Regression 0.09 -414.40 -414.06 0.22 0.11 Figure 4.10 displays simple and hierarchical linear regression \\(S_{or}\\) vs \\(\\log{k_{abs}}\\) models, grouped by reservoir. Black dots represent observed samples, light blue lines represent samples from the posterior distribution of intercept and slope parameters, and dark blue lines represent mean intercept and slope parameters, for each reservoir. Completely pooled, simple linear regression models display larger between-groups slope variations and uncertainty, as shown in Figure 4.11. Reservoirs with large number of samples, such as reservoir F, show only small changes between hierarchical and simple linear regression model posterior distributions. A stronger regularizing effect is displayed in reservoir I, which contains a small number of samples. Overall behavior consistency of \\(S_{or}\\) with respect to \\(\\log{k_{abs}}\\) is increased in the hierarchical partially pooled linear model, as slopes are regressed towards a common mean. As information is shared between different reservoirs, posterior uncertainties are noticeably reduced in the hierarchical linear model. Figure 4.10: Simple (top) and Hierarchical (bottom) linear regression models of Sor vs log(kabs), grouped by reservoir. Figure 4.11: Intercept (top) and slope (bottom), simple and hierarchical linear regression Sor vs log(kabs) model parameters, grouped by reservoir. Hierarchical varying slope and simple linear regression models of oil relative permeability at irreducible water saturation condition \\(k_{ro}@S_{wi}\\) and logarithm of absolute permeability \\(\\log{k_{abs}}\\) were evaluated on the assembled dataset. Table 4.3 displays the obtained regression metrics for each fitted model. Hierarchical linear regression achieved slightly better WAIC, LOOIC and \\(R_{adj}^2\\) metrics. Table 4.3: \\(k_{ro}@S_{wi}\\) linear regression model metrics. Regression Model RMSE WAIC LOOIC \\(R^2\\) \\(R_{adj}^2\\) Simple Linear Regression 0.20 -48.72 -47.50 0.34 0.28 Hierarchical Linear Regression 0.20 -62.02 -61.77 0.39 0.33 Figure 4.12 displays simple and hierarchical linear regression \\(k_{ro}@S_{wi}\\) vs \\(\\log{k_{abs}}\\) models, grouped by reservoir. Black dots represent observed samples, light blue lines represent samples from the posterior distribution of intercept and slope parameters, and dark blue lines represent mean intercept and slope parameters, for each reservoir. Completely pooled, simple linear regression models display larger between-groups slope variations and uncertainty, as shown in Figure 4.13. Reservoirs with large number of samples, such as reservoir F, show only small changes between hierarchical and simple linear regression model posterior distributions. A stronger regularizing effect is displayed in reservoir D, which contains a small number of samples. Overall behavior consistency of \\(k_{ro}@S_{wi}\\) in respect to \\(\\log{k_{abs}}\\) is increased in the hierarchical partially pooled linear model, as slopes are regressed towards a common mean. As information is shared between different reservoirs, posterior uncertainties are noticeably reduced in the hierarchical linear model. Figure 4.12: Simple (top) and Hierarchical (bottom) linear regression models of kro@Swi vs log(kabs), grouped by reservoir. Figure 4.13: Intercept (top) and slope (bottom), simple and hierarchical linear regression kro@Swi vs log(kabs) model parameters, grouped by reservoir. Hierarchical varying slope and simple linear regression models of water relative permeability at residual oil saturation condition \\(k_{rw}@S_{or}\\) and logarithm of absolute permeability \\(\\log{k_{abs}}\\) were evaluated on the assembled dataset. Table 4.4 displays the obtained regression metrics for each fitted model. Hierarchical linear regression achieved slightly better WAIC, LOOIC and \\(R_{adj}^2\\) metrics. Table 4.4: \\(k_{rw}@S_{or}\\) linear regression model metrics. Regression Model RMSE WAIC LOOIC \\(R^2\\) \\(R_{adj}^2\\) Simple Linear Regression 0.10 -366.62 -366.13 0.20 0.16 Hierarchical Linear Regression 0.10 -372.34 -372.18 0.24 0.17 Figure 4.14 displays simple and hierarchical linear regression \\(k_{rw}@S_{or}\\) vs \\(\\log{k_{abs}}\\) models, grouped by reservoir. Black dots represent observed samples, light blue lines represent samples from the posterior distribution of intercept and slope parameters, and dark blue lines represent mean intercept and slope parameters, for each reservoir. Completely pooled, simple linear regression models display larger between-groups slope variations and uncertainty, as shown in Figure 4.15. Reservoirs with large number of samples, such as reservoir F, show only small changes between hierarchical and simple linear regression model posterior distributions. A stronger regularizing effect is displayed in reservoir D, which contains a small number of samples. Overall behavior consistency of \\(k_{rw}@S_{or}\\) in respect to \\(\\log{k_{abs}}\\) is increased in the hierarchical partially pooled linear model, as slopes are regressed towards a common mean. As information is shared between different reservoirs, posterior uncertainties are noticeably reduced in the hierarchical linear model. Figure 4.14: Simple (top) and Hierarchical (bottom) linear regression models of krw@Sor vs log(kabs), grouped by reservoir. Figure 4.15: Intercept (top) and slope (bottom), simple and hierarchical linear regression krw@Sor vs log(kabs) model parameters, grouped by reservoir. Posterior distribution of latent \\(\\mu_\\alpha\\) and \\(\\mu_\\beta\\) parameters of hierarchical linear regression models represent average behavior of model parameters across the different evaluated categories. Thus, they represent quantified petrophysical parameter model analogues, and may be used for preliminary characterization of reservoirs with similar characteristics as the ones used in the assembled model, but with no sampled data. Multi-task simple and varying slopes hierarchical linear regression models, grouped by reservoir, were fitted to the assembled LET relative permeability parameter dataset. Comparison of WAIC and LOOIC metrics between them is shown in Table 4.5, displaying slightly better results for the multi-task hierarchical linear regression model. Table 4.5: Multi-task linear regression model metrics. Regression Model WAIC LOOIC Simple Linear Regression 1119.6 1129.8 Hierarchical Linear Regression 1043.3 1048.0 The posterior distribution of the LET relative permeability parameters for a given reservoir and logarithmic absolute permeability may be used to sample relative permeability curves, fully incorporating the information from the available dataset, as exemplified in Figure 4.16. Figure 4.16: Example of multivariate posterior sample of relative permeability curves, fully incorporating the information from the available dataset. References "],
["conclusion.html", "Conclusion", " Conclusion In this work, machine learning and statistical regression models were evaluated for the prediction of routine and special core analysis petrophysical properties on datasets containing experimental results for rock samples from many Brazilian reservoirs. Several feature engineering and machine learning techniques were evaluated for the estimation of absolute permeability from mercury injection capillary pressure curves. The absolute permeability regression models that achieved the lowest median absolute errors and largest correlation coefficients used the support-vector machine (SVR), random forest or gradient boosted decision trees algorithms, and several features extracted from the mercury porosimetry capillary pressure curve data. Among the linear models for prediction of absolute permeability, the models proposed by Swanson (Swanson 1981) and Winland (Kolodzie 1980) obtained the lowest root mean squared errors and highest correlation coefficients. Using a parametric formulation, special core analysis capillary pressure and relative permeability curve regression problems were framed in a multi-task regression approach. For the estimation of capillary pressure curve parameters, an analytic formulation of the multi-task linear regression problem was considered using the multivariate gaussian conditional distribution. This model was evaluated on an experimental dataset, comparing average predictions and samples from the conditional distribution of parameters, to the observed capillary pressure curve parameters. Although significant dispersion of experimental and predicted parameters values were observed, it was possible to identify that predictions followed expected linear tendencies of capillary pressure curve parameters and absolute permeability. Posterior distribution of partially pooled varying slopes hierarchical and completely pooled simple linear regression models, with respect to logarithmic absolute permeability, were inferred for relative permeability parameters. Hierarchical linear regression models displayed overall improved information criteria metrics, evaluated using bayesian Watanabe-Akaike and Leave-one-out information criteria. Due to the regularizing effect of the information sharing between different reservoir categories, posterior distribution of relative permeability parameters of hierarchical linear regression models displayed smaller uncertainties and greater consistency. Posterior distribution of latent parameters of hierarchical linear regression models represent average behavior of model parameters across the different evaluated categories and may be used as quantified petrophysical parameter model analogues for petrophysical characterization of reservoirs with similar characteristics as the ones used in the assembled model, but with no sampled data. References "],
["bibliography.html", "Bibliography", " Bibliography "]
]
